/**
 * x402-stacks - Express Middleware (Coinbase Compatible)
 * Middleware for handling x402 payment requirements in Express.js applications
 */
import { Request, Response, NextFunction } from 'express';
import { NetworkV2, PaymentRequiredV2, SettlementResponseV2 } from './types-v2';
import { NetworkType, TokenType, TokenContract } from './types';
/**
 * Configuration for x402 payment middleware
 */
export interface PaymentMiddlewareConfig {
    /** Payment scheme (default: "exact") */
    scheme?: string;
    /** Network in CAIP-2 format or V1 format (will be converted) */
    network: NetworkV2 | NetworkType;
    /** Required payment amount in atomic units (microSTX, satoshis, etc.) */
    amount: string | bigint;
    /** Asset identifier ("STX", "SBTC", "USDCX", or contract identifier) */
    asset?: string;
    /** Token type for V1 compatibility (converted to asset) */
    tokenType?: TokenType;
    /** Token contract for V1 compatibility */
    tokenContract?: TokenContract;
    /** Recipient address */
    payTo: string;
    /** Maximum time allowed for payment completion (default: 300) */
    maxTimeoutSeconds?: number;
    /** Facilitator API URL */
    facilitatorUrl?: string;
    /** Resource description */
    description?: string;
    /** Resource MIME type */
    mimeType?: string;
    /** Custom payment validator */
    paymentValidator?: (payment: SettlementResponseV2) => boolean | Promise<boolean>;
    /** Additional scheme-specific data */
    extra?: Record<string, unknown>;
}
/**
 * Express middleware for x402 payment requirements
 * Compatible with Coinbase x402 protocol
 */
export declare function paymentMiddleware(config: PaymentMiddlewareConfig): (req: Request, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>;
/**
 * Utility to get payment info from request
 */
export declare function getPayment(req: Request): SettlementResponseV2 | undefined;
/**
 * Create a simple payment gate that requires payment before proceeding
 */
export declare function createPaymentGate(config: PaymentMiddlewareConfig): (req: Request, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>;
/**
 * Conditional payment middleware - only require payment if condition is met
 */
export declare function conditionalPayment(condition: (req: Request) => boolean | Promise<boolean>, config: PaymentMiddlewareConfig): (req: Request, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>;
/**
 * Tiered payment middleware - different amounts based on request
 */
export declare function tieredPayment(getTier: (req: Request) => {
    amount: string | bigint;
    description?: string;
} | Promise<{
    amount: string | bigint;
    description?: string;
}>, baseConfig: Omit<PaymentMiddlewareConfig, 'amount' | 'description'>): (req: Request, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>;
/**
 * Rate limiting with payment - require payment after free tier
 */
export declare function paymentRateLimit(config: {
    freeRequests: number;
    windowMs: number;
    paymentConfig: PaymentMiddlewareConfig;
    keyGenerator?: (req: Request) => string;
}): (req: Request, res: Response, next: NextFunction) => Promise<void | Response<any, Record<string, any>>>;
/**
 * Parse payment-required header from a 402 response
 */
export declare function parsePaymentRequiredHeader(header: string): PaymentRequiredV2 | null;
/**
 * Parse payment-response header from a successful response
 */
export declare function parsePaymentResponseHeader(header: string): SettlementResponseV2 | null;
/** @deprecated Use PaymentMiddlewareConfig instead */
export type X402MiddlewareConfigV2 = PaymentMiddlewareConfig;
/** @deprecated Use paymentMiddleware instead */
export declare const x402PaymentRequiredV2: typeof paymentMiddleware;
/** @deprecated Use getPayment instead */
export declare const getPaymentV2: typeof getPayment;
/** @deprecated Use createPaymentGate instead */
export declare const createPaymentGateV2: typeof createPaymentGate;
/** @deprecated Use conditionalPayment instead */
export declare const conditionalPaymentV2: typeof conditionalPayment;
/** @deprecated Use tieredPayment instead */
export declare const tieredPaymentV2: typeof tieredPayment;
/** @deprecated Use paymentRateLimit instead */
export declare const paymentRateLimitV2: typeof paymentRateLimit;
